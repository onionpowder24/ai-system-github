<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nitto AI Avatar System - アーキテクチャ解説</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; background: #f5f7fa; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px 0; margin-bottom: 30px; border-radius: 10px; }
        .header h1 { text-align: center; font-size: 2.5em; margin-bottom: 10px; }
        .header p { text-align: center; font-size: 1.2em; opacity: 0.9; }
        .section { background: white; margin: 20px 0; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .section h2 { color: #4a5568; border-bottom: 3px solid #667eea; padding-bottom: 10px; margin-bottom: 20px; }
        .section h3 { color: #2d3748; margin: 20px 0 10px 0; }
        .flow-diagram { display: flex; justify-content: space-between; align-items: center; margin: 20px 0; flex-wrap: wrap; }
        .flow-step { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 8px; margin: 5px; flex: 1; min-width: 200px; text-align: center; position: relative; }
        .flow-step:not(:last-child)::after { content: '→'; position: absolute; right: -15px; top: 50%; transform: translateY(-50%); color: #667eea; font-size: 1.5em; font-weight: bold; }
        .highlight { background: linear-gradient(90deg, #ffecd2 0%, #fcb69f 100%); padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #ff6b6b; }
        .code-block { background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin: 15px 0; font-family: 'Courier New', monospace; overflow-x: auto; }
        .before-after { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .before, .after { padding: 20px; border-radius: 8px; }
        .before { background: #fee; border-left: 4px solid #ff4757; }
        .after { background: #efe; border-left: 4px solid #2ed573; }
        .tech-stack { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0; }
        .tech-item { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea; }
        .achievement { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: center; }
        ul { margin: 15px 0; padding-left: 20px; }
        li { margin: 5px 0; }
        .emoji { font-size: 1.2em; margin-right: 8px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🤖 Nitto AI Avatar System</h1>
            <p>企業AI対話システム - 高精度RAG × 3D VRMアバター</p>
        </div>

        <div class="section">
            <h2>🎯 システム概要</h2>
            <p>Nitto AI Avatar Systemは、日東電工株式会社の統合報告書を知識ベースとした企業情報提供専用のAI対話システムです。Unity 3D VRMアバターとPython APIサーバーを組み合わせ、リアルタイムでの高品質な企業情報対話を実現します。</p>
            
            <div class="highlight">
                <strong>🏆 主要革新:</strong> 従来のFAISS検索の根本的品質問題（事業内容質問で役員報酬スライドが選ばれる等）を、Gemini知能選択システムで本質的に解決
            </div>
        </div>

        <div class="section">
            <h2>🏗️ システムアーキテクチャ</h2>
            
            <div class="flow-diagram">
                <div class="flow-step">
                    <strong>Unity 3D Avatar</strong><br>
                    VRMアバター<br>
                    音声対話UI
                </div>
                <div class="flow-step">
                    <strong>Python API</strong><br>
                    FastAPI サーバー<br>
                    ポート7200
                </div>
                <div class="flow-step">
                    <strong>Gemini AI</strong><br>
                    知能スライド選択<br>
                    応答生成
                </div>
                <div class="flow-step">
                    <strong>Azure Speech</strong><br>
                    音声合成<br>
                    WAV出力
                </div>
            </div>

            <h3>📊 技術スタック</h3>
            <div class="tech-stack">
                <div class="tech-item">
                    <strong>🎮 フロントエンド</strong>
                    <ul>
                        <li>Unity 2022.3 LTS</li>
                        <li>VRM 3D アバター</li>
                        <li>AudioSource システム</li>
                    </ul>
                </div>
                <div class="tech-item">
                    <strong>🔧 バックエンド</strong>
                    <ul>
                        <li>Python 3.12</li>
                        <li>FastAPI + uvicorn</li>
                        <li>SQLite データベース</li>
                    </ul>
                </div>
                <div class="tech-item">
                    <strong>🧠 AI システム</strong>
                    <ul>
                        <li>Google Gemini 1.5 Pro</li>
                        <li>FAISS ベクトル検索</li>
                        <li>BM25 キーワード検索</li>
                    </ul>
                </div>
                <div class="tech-item">
                    <strong>🎵 音声処理</strong>
                    <ul>
                        <li>Azure Speech Services</li>
                        <li>日本語音声合成</li>
                        <li>WAV形式出力</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>⚡ 技術革新 - Gemini知能スライド選択システム</h2>
            
            <div class="before-after">
                <div class="before">
                    <h3>❌ Before: FAISS単体</h3>
                    <ul>
                        <li>「事業内容は？」→ slide_65（役員報酬）</li>
                        <li>意味理解なしの機械的選択</li>
                        <li>関連性の低いスライド選択</li>
                        <li>ユーザー困惑</li>
                    </ul>
                </div>
                <div class="after">
                    <h3>✅ After: Gemini知能選択</h3>
                    <ul>
                        <li>15候補から意味理解ベース選択</li>
                        <li>質問内容と直接関連するスライド</li>
                        <li>財務→財務データ、事業→事業説明</li>
                        <li>高精度な情報提供</li>
                    </ul>
                </div>
            </div>

            <h3>🔍 動作フロー</h3>
            <div class="flow-diagram">
                <div class="flow-step">FAISS検索<br>15候補取得</div>
                <div class="flow-step">Gemini判定<br>意味理解選択</div>
                <div class="flow-step">品質チェック<br>ハルシネーション検出</div>
                <div class="flow-step">最適回答<br>音声合成</div>
            </div>
        </div>

        <div class="section">
            <h2>🔍 品質管理システム</h2>
            
            <h3>多段階品質保証</h3>
            <div class="code-block">
1. <strong>初回検索</strong>: FAISS + BM25 ハイブリッド検索で候補収集
2. <strong>知能選択</strong>: Gemini による質問-スライド適合性評価
3. <strong>品質チェック</strong>: ハルシネーション検出システム
4. <strong>自動再検索</strong>: 不適切時の代替候補選択
5. <strong>最終保証</strong>: 全失敗時はslide_1フォールバック
            </div>

            <div class="highlight">
                <strong>🎯 開発哲学:</strong> 「その場しのぎではなく本質的解決」- 個別キーワード対応ではなく、システム全体の品質向上を重視
            </div>
        </div>

        <div class="section">
            <h2>📈 包括的知識対応</h2>
            
            <h3>専門分野制限の撤廃</h3>
            <div class="before-after">
                <div class="before">
                    <h3>❌ Before: データサイエンス特化</h3>
                    <ul>
                        <li>「財務は専門外」で回答拒否</li>
                        <li>統合報告書の知識を活用せず</li>
                        <li>限定的な情報提供</li>
                    </ul>
                </div>
                <div class="after">
                    <h3>✅ After: 全領域対応</h3>
                    <ul>
                        <li>財務・業績・技術・ESG全対応</li>
                        <li>統合報告書全内容を活用</li>
                        <li>包括的な企業情報提供</li>
                    </ul>
                </div>
            </div>

            <h3>対応領域</h3>
            <ul>
                <li><span class="emoji">💰</span><strong>財務情報</strong>: 売上高、営業利益、ROE等</li>
                <li><span class="emoji">🏢</span><strong>事業戦略</strong>: 事業内容、技術、製品</li>
                <li><span class="emoji">🌱</span><strong>ESG</strong>: 環境、社会、ガバナンス</li>
                <li><span class="emoji">🎯</span><strong>経営理念</strong>: Mission、Vision、価値観</li>
            </ul>
        </div>

        <div class="section">
            <h2>🚀 主要機能</h2>
            
            <div class="tech-stack">
                <div class="tech-item">
                    <strong>🤖 3D VRMアバター</strong>
                    <ul>
                        <li>リアルタイム音声対話</li>
                        <li>表情・アニメーション</li>
                        <li>スライド画像表示</li>
                    </ul>
                </div>
                <div class="tech-item">
                    <strong>📊 高精度RAG</strong>
                    <ul>
                        <li>統合報告書知識ベース</li>
                        <li>Gemini知能選択</li>
                        <li>コンテキスト理解</li>
                    </ul>
                </div>
                <div class="tech-item">
                    <strong>🔍 品質管理</strong>
                    <ul>
                        <li>ハルシネーション検出</li>
                        <li>多段階検証</li>
                        <li>自動品質向上</li>
                    </ul>
                </div>
                <div class="tech-item">
                    <strong>🎵 音声合成</strong>
                    <ul>
                        <li>Azure Speech Services</li>
                        <li>日本語自然音声</li>
                        <li>WAVストリーミング</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>🎯 使用例とテストケース</h2>
            
            <h3>推奨テスト質問</h3>
            <div class="code-block">
✅ <strong>事業関連</strong>
• "Nittoの事業内容は？" → 適切な事業説明スライド

✅ <strong>財務関連</strong>  
• "2024年度の売上高は？" → "1兆139億円" + 財務データスライド

✅ <strong>経営理念</strong>
• "会社の理念は？" → Mission/Vision + 理念スライド

✅ <strong>技術関連</strong>
• "どんな技術を持っていますか？" → 技術説明スライド

❌ <strong>NGケース</strong>
• "今日の天気は？" → slide_1 + 適切なNG応答
            </div>
        </div>

        <div class="achievement">
            <h2>🏆 Achievement Unlocked</h2>
            <p><strong>本質的システム改革達成！</strong></p>
            <p>FAISS検索の根本問題から → Gemini知能選択システムへの完全進化</p>
            <p>「役員報酬スライドが事業内容で選ばれる異常」→「適切なスライド選択の常識」</p>
        </div>

        <div class="section">
            <h2>📚 開発経緯と哲学</h2>
            
            <h3>重要な技術的ブレークスルー</h3>
            <div class="highlight">
                <strong>1. FAISS検索品質問題の本質的解決</strong><br>
                問題: 「事業内容」質問でslide_65（役員報酬）が1位選択される異常<br>
                解決: Gemini知能選択システムで15候補から最適スライドを選択
            </div>
            
            <div class="highlight">
                <strong>2. ハルシネーション完全無効化問題の解決</strong><br>
                問題: <code>if False:</code> でチェック機能が停止<br>
                解決: 適切なハルシネーション検出システムの復活と品質向上
            </div>
            
            <div class="highlight">
                <strong>3. 専門分野制限の撤廃</strong><br>
                問題: 「データサイエンスが専門だから財務は答えられない」<br>
                解決: 統合報告書全領域対応で包括的回答実現
            </div>

            <h3>💡 開発哲学</h3>
            <ul>
                <li><strong>本質重視</strong>: 個別対応ではなく根本原因の解決</li>
                <li><strong>品質第一</strong>: 複数段階での品質管理システム</li>
                <li><strong>包括性</strong>: 企業情報の全領域対応</li>
                <li><strong>拡張性</strong>: 他企業への応用可能な設計</li>
            </ul>
        </div>

        <div class="section">
            <h2>🔧 セットアップと運用</h2>
            
            <h3>環境要件</h3>
            <ul>
                <li>Python 3.12+</li>
                <li>Unity 2022.3 LTS+</li>
                <li>Google Gemini API キー</li>
                <li>Azure Speech Services API キー</li>
            </ul>

            <h3>起動手順</h3>
            <div class="code-block">
# 1. APIサーバー起動
cd python_server
python -m uvicorn src.web.api:app --host 0.0.0.0 --port 7200

# 2. Unity起動
# unity_avatar/aituber_3d/ プロジェクトをUnityで開く

# 3. 対話開始
# Playボタン押下 → 質問入力 → AI応答
            </div>
        </div>

        <div class="section">
            <h2>🤝 プロジェクト情報</h2>
            <p><strong>開発</strong>: Nitto データサイエンスグループ</p>
            <p><strong>GitHub</strong>: <a href="https://github.com/onionpowder24" target="_blank">@onionpowder24</a></p>
            <p><strong>目的</strong>: 企業情報提供・技術デモンストレーション</p>
            
            <div class="highlight">
                <strong>🎯 このAIアバターはデータサイエンスグループが開発しました</strong><br>
                開発チームのクレジット表示として、アバターの自己紹介に含まれています
            </div>
        </div>
    </div>
</body>
</html>